#!/command/with-contenv bashio
# shellcheck shell=bash
# ==============================================================================
# Start service
# ==============================================================================
export PYTHONPATH=/usr/src

extra_args=()
if bashio::config.true 'debug_logging'; then
    extra_args+=('--debug')
fi

exec python3 -m wyoming_satellite \
    --name 'assist microphone' \
    --uri 'tcp://0.0.0.0:10700' \
    --mic-command 'arecord -r 16000 -c 1 -f S16_LE -t raw' \
    --snd-command 'aplay -r 16000 -c 1 -f S16_LE -t raw' \
    --snd-command-rate 16000 \
    --awake-wav "$(bashio::config 'awake_wav')" \
    --done-wav "$(bashio::config 'done_wav')" \
    --snd-volume-multiplier "$(bashio::config 'snd_volume_multiplier')" \
    --no-zeroconf ${extra_args[@]}
